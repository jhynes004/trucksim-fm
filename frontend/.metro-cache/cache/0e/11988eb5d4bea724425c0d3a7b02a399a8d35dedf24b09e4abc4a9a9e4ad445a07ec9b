{"dependencies":[{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"getLivePresenter\", {\n    enumerable: true,\n    get: function () {\n      return getLivePresenter;\n    }\n  });\n  var _axios = require(_dependencyMap[0], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL || '';\n\n  // Default auto-DJ when no live show\n  const AUTO_DJ = {\n    name: 'DJ Cruise Control',\n    description: 'Full throttle tunes...',\n    showName: 'Auto DJ',\n    photoUrl: null,\n    isAutoDJ: true\n  };\n  /**\n   * Check if a show is currently live based on time\n   */\n  const isShowLive = (show, now) => {\n    const startTime = new Date(show.start_time);\n    const endTime = new Date(show.end_time);\n    if (show.permanent) {\n      // For permanent/recurring shows, match by day of week and time only\n      // getUTCDay(): 0 = Sunday, 1 = Monday, ..., 6 = Saturday\n      const nowDay = now.getUTCDay();\n      const showDay = startTime.getUTCDay();\n      const nowHours = now.getUTCHours();\n      const nowMinutes = now.getUTCMinutes();\n      const nowTotalMinutes = nowHours * 60 + nowMinutes;\n      const startHours = startTime.getUTCHours();\n      const startMinutes = startTime.getUTCMinutes();\n      const startTotalMinutes = startHours * 60 + startMinutes;\n      const endHours = endTime.getUTCHours();\n      const endMinutes = endTime.getUTCMinutes();\n      const endTotalMinutes = endHours * 60 + endMinutes;\n      const isSameDay = nowDay === showDay;\n      const isWithinTime = nowTotalMinutes >= startTotalMinutes && nowTotalMinutes < endTotalMinutes;\n\n      // Debug logging\n      console.log(`[isShowLive] ${show.show_name}: nowDay=${nowDay}, showDay=${showDay}, ` + `nowTime=${nowHours}:${nowMinutes} (${nowTotalMinutes}min), ` + `showTime=${startHours}:${startMinutes}-${endHours}:${endMinutes} (${startTotalMinutes}-${endTotalMinutes}min), ` + `sameDay=${isSameDay}, withinTime=${isWithinTime}`);\n      return isSameDay && isWithinTime;\n    } else {\n      // For one-time shows, check if current timestamp is within the exact range\n      const isLive = now >= startTime && now < endTime;\n      console.log(`[isShowLive] ${show.show_name} (one-time): ` + `now=${now.toISOString()}, start=${startTime.toISOString()}, end=${endTime.toISOString()}, ` + `isLive=${isLive}`);\n      return isLive;\n    }\n  };\n\n  /**\n   * Fetch the current live presenter from schedule data\n   */\n  const getLivePresenter = async () => {\n    try {\n      console.log('[PresenterService] Fetching schedule for live presenter check');\n      const response = await axios.default.get(`${BACKEND_URL}/api/schedule`, {\n        timeout: 10000\n      });\n      if (!response.data || !response.data.success || !Array.isArray(response.data.data)) {\n        console.log('[PresenterService] Invalid schedule response, returning auto-DJ');\n        return AUTO_DJ;\n      }\n      const scheduleData = response.data.data;\n      const now = new Date();\n      console.log(`[PresenterService] Current UTC: ${now.toISOString()}, Day: ${now.getUTCDay()}, Hour: ${now.getUTCHours()}`);\n      console.log(`[PresenterService] Checking ${scheduleData.length} shows for live presenter`);\n\n      // Find the currently live show - check permanent shows first as they're recurring\n      // Sort to prioritize permanent shows that match the current time slot\n      const sortedShows = [...scheduleData].sort((a, b) => {\n        // Prioritize permanent shows\n        if (a.permanent && !b.permanent) return -1;\n        if (!a.permanent && b.permanent) return 1;\n        return 0;\n      });\n      const liveShow = sortedShows.find(show => {\n        // Skip shows without a presenter\n        if (!show.users_permissions_user) return false;\n        return isShowLive(show, now);\n      });\n      if (liveShow && liveShow.users_permissions_user) {\n        const presenter = liveShow.users_permissions_user;\n        const photoUrl = presenter.profile_photo?.url ? `https://trucksim.fm${presenter.profile_photo.url}` : null;\n        console.log('[PresenterService] Found live presenter:', presenter.username, 'Show:', liveShow.show_name);\n        return {\n          name: presenter.username,\n          description: liveShow.description || '',\n          showName: liveShow.show_name,\n          photoUrl,\n          isAutoDJ: false,\n          endTime: liveShow.end_time\n        };\n      }\n      console.log('[PresenterService] No live show found, returning auto-DJ');\n      return AUTO_DJ;\n    } catch (error) {\n      console.error('[PresenterService] Error fetching live presenter:', error);\n      return AUTO_DJ;\n    }\n  };\n});","lineCount":115,"map":[[12,2,88,0,"Object"],[12,8,88,0],[12,9,88,0,"defineProperty"],[12,23,88,0],[12,24,88,0,"exports"],[12,31,88,0],[13,4,88,0,"enumerable"],[13,14,88,0],[14,4,88,0,"get"],[14,7,88,0],[14,18,88,0,"get"],[14,19,88,0],[15,6,88,0],[15,13,88,0,"getLivePresenter"],[15,29,88,0],[16,4,88,0],[17,2,88,0],[18,2,1,0],[18,6,1,0,"_axios"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,1,0],[19,6,1,0,"axios"],[19,11,1,0],[19,14,1,0,"_interopDefault"],[19,29,1,0],[19,30,1,0,"_axios"],[19,36,1,0],[20,2,3,0],[20,8,3,6,"BACKEND_URL"],[20,19,3,17],[20,22,3,20,"process"],[20,29,3,27],[20,30,3,28,"env"],[20,33,3,31],[20,34,3,32,"EXPO_PUBLIC_BACKEND_URL"],[20,57,3,55],[20,61,3,59],[20,63,3,61],[22,2,5,0],[23,2,6,0],[23,8,6,6,"AUTO_DJ"],[23,15,6,13],[23,18,6,16],[24,4,7,2,"name"],[24,8,7,6],[24,10,7,8],[24,29,7,27],[25,4,8,2,"description"],[25,15,8,13],[25,17,8,15],[25,41,8,39],[26,4,9,2,"showName"],[26,12,9,10],[26,14,9,12],[26,23,9,21],[27,4,10,2,"photoUrl"],[27,12,10,10],[27,14,10,12],[27,18,10,16],[28,4,11,2,"isAutoDJ"],[28,12,11,10],[28,14,11,12],[29,2,12,0],[29,3,12,1],[30,2,38,0],[31,0,39,0],[32,0,40,0],[33,2,41,0],[33,8,41,6,"isShowLive"],[33,18,41,16],[33,21,41,19,"isShowLive"],[33,22,41,20,"show"],[33,26,41,38],[33,28,41,40,"now"],[33,31,41,49],[33,36,41,63],[34,4,42,2],[34,10,42,8,"startTime"],[34,19,42,17],[34,22,42,20],[34,26,42,24,"Date"],[34,30,42,28],[34,31,42,29,"show"],[34,35,42,33],[34,36,42,34,"start_time"],[34,46,42,44],[34,47,42,45],[35,4,43,2],[35,10,43,8,"endTime"],[35,17,43,15],[35,20,43,18],[35,24,43,22,"Date"],[35,28,43,26],[35,29,43,27,"show"],[35,33,43,31],[35,34,43,32,"end_time"],[35,42,43,40],[35,43,43,41],[36,4,45,2],[36,8,45,6,"show"],[36,12,45,10],[36,13,45,11,"permanent"],[36,22,45,20],[36,24,45,22],[37,6,46,4],[38,6,47,4],[39,6,48,4],[39,12,48,10,"nowDay"],[39,18,48,16],[39,21,48,19,"now"],[39,24,48,22],[39,25,48,23,"getUTCDay"],[39,34,48,32],[39,35,48,33],[39,36,48,34],[40,6,49,4],[40,12,49,10,"showDay"],[40,19,49,17],[40,22,49,20,"startTime"],[40,31,49,29],[40,32,49,30,"getUTCDay"],[40,41,49,39],[40,42,49,40],[40,43,49,41],[41,6,51,4],[41,12,51,10,"nowHours"],[41,20,51,18],[41,23,51,21,"now"],[41,26,51,24],[41,27,51,25,"getUTCHours"],[41,38,51,36],[41,39,51,37],[41,40,51,38],[42,6,52,4],[42,12,52,10,"nowMinutes"],[42,22,52,20],[42,25,52,23,"now"],[42,28,52,26],[42,29,52,27,"getUTCMinutes"],[42,42,52,40],[42,43,52,41],[42,44,52,42],[43,6,53,4],[43,12,53,10,"nowTotalMinutes"],[43,27,53,25],[43,30,53,28,"nowHours"],[43,38,53,36],[43,41,53,39],[43,43,53,41],[43,46,53,44,"nowMinutes"],[43,56,53,54],[44,6,55,4],[44,12,55,10,"startHours"],[44,22,55,20],[44,25,55,23,"startTime"],[44,34,55,32],[44,35,55,33,"getUTCHours"],[44,46,55,44],[44,47,55,45],[44,48,55,46],[45,6,56,4],[45,12,56,10,"startMinutes"],[45,24,56,22],[45,27,56,25,"startTime"],[45,36,56,34],[45,37,56,35,"getUTCMinutes"],[45,50,56,48],[45,51,56,49],[45,52,56,50],[46,6,57,4],[46,12,57,10,"startTotalMinutes"],[46,29,57,27],[46,32,57,30,"startHours"],[46,42,57,40],[46,45,57,43],[46,47,57,45],[46,50,57,48,"startMinutes"],[46,62,57,60],[47,6,59,4],[47,12,59,10,"endHours"],[47,20,59,18],[47,23,59,21,"endTime"],[47,30,59,28],[47,31,59,29,"getUTCHours"],[47,42,59,40],[47,43,59,41],[47,44,59,42],[48,6,60,4],[48,12,60,10,"endMinutes"],[48,22,60,20],[48,25,60,23,"endTime"],[48,32,60,30],[48,33,60,31,"getUTCMinutes"],[48,46,60,44],[48,47,60,45],[48,48,60,46],[49,6,61,4],[49,12,61,10,"endTotalMinutes"],[49,27,61,25],[49,30,61,28,"endHours"],[49,38,61,36],[49,41,61,39],[49,43,61,41],[49,46,61,44,"endMinutes"],[49,56,61,54],[50,6,63,4],[50,12,63,10,"isSameDay"],[50,21,63,19],[50,24,63,22,"nowDay"],[50,30,63,28],[50,35,63,33,"showDay"],[50,42,63,40],[51,6,64,4],[51,12,64,10,"isWithinTime"],[51,24,64,22],[51,27,64,25,"nowTotalMinutes"],[51,42,64,40],[51,46,64,44,"startTotalMinutes"],[51,63,64,61],[51,67,64,65,"nowTotalMinutes"],[51,82,64,80],[51,85,64,83,"endTotalMinutes"],[51,100,64,98],[53,6,66,4],[54,6,67,4,"console"],[54,13,67,11],[54,14,67,12,"log"],[54,17,67,15],[54,18,67,16],[54,34,67,32,"show"],[54,38,67,36],[54,39,67,37,"show_name"],[54,48,67,46],[54,60,67,58,"nowDay"],[54,66,67,64],[54,79,67,77,"showDay"],[54,86,67,84],[54,90,67,88],[54,93,68,6],[54,104,68,17,"nowHours"],[54,112,68,25],[54,116,68,29,"nowMinutes"],[54,126,68,39],[54,131,68,44,"nowTotalMinutes"],[54,146,68,59],[54,154,68,67],[54,157,69,6],[54,169,69,18,"startHours"],[54,179,69,28],[54,183,69,32,"startMinutes"],[54,195,69,44],[54,199,69,48,"endHours"],[54,207,69,56],[54,211,69,60,"endMinutes"],[54,221,69,70],[54,226,69,75,"startTotalMinutes"],[54,243,69,92],[54,247,69,96,"endTotalMinutes"],[54,262,69,111],[54,270,69,119],[54,273,70,6],[54,284,70,17,"isSameDay"],[54,293,70,26],[54,309,70,42,"isWithinTime"],[54,321,70,54],[54,323,70,56],[54,324,70,57],[55,6,72,4],[55,13,72,11,"isSameDay"],[55,22,72,20],[55,26,72,24,"isWithinTime"],[55,38,72,36],[56,4,73,2],[56,5,73,3],[56,11,73,9],[57,6,74,4],[58,6,75,4],[58,12,75,10,"isLive"],[58,18,75,16],[58,21,75,19,"now"],[58,24,75,22],[58,28,75,26,"startTime"],[58,37,75,35],[58,41,75,39,"now"],[58,44,75,42],[58,47,75,45,"endTime"],[58,54,75,52],[59,6,77,4,"console"],[59,13,77,11],[59,14,77,12,"log"],[59,17,77,15],[59,18,77,16],[59,34,77,32,"show"],[59,38,77,36],[59,39,77,37,"show_name"],[59,48,77,46],[59,63,77,61],[59,66,78,6],[59,73,78,13,"now"],[59,76,78,16],[59,77,78,17,"toISOString"],[59,88,78,28],[59,89,78,29],[59,90,78,30],[59,101,78,41,"startTime"],[59,110,78,50],[59,111,78,51,"toISOString"],[59,122,78,62],[59,123,78,63],[59,124,78,64],[59,133,78,73,"endTime"],[59,140,78,80],[59,141,78,81,"toISOString"],[59,152,78,92],[59,153,78,93],[59,154,78,94],[59,158,78,98],[59,161,79,6],[59,171,79,16,"isLive"],[59,177,79,22],[59,179,79,24],[59,180,79,25],[60,6,81,4],[60,13,81,11,"isLive"],[60,19,81,17],[61,4,82,2],[62,2,83,0],[62,3,83,1],[64,2,85,0],[65,0,86,0],[66,0,87,0],[67,2,88,7],[67,8,88,13,"getLivePresenter"],[67,24,88,29],[67,27,88,32],[67,33,88,32,"getLivePresenter"],[67,34,88,32],[67,39,88,68],[68,4,89,2],[68,8,89,6],[69,6,90,4,"console"],[69,13,90,11],[69,14,90,12,"log"],[69,17,90,15],[69,18,90,16],[69,81,90,79],[69,82,90,80],[70,6,92,4],[70,12,92,10,"response"],[70,20,92,18],[70,23,92,21],[70,29,92,27,"axios"],[70,34,92,32],[70,35,92,32,"default"],[70,42,92,32],[70,43,92,33,"get"],[70,46,92,36],[70,47,92,37],[70,50,92,40,"BACKEND_URL"],[70,61,92,51],[70,76,92,66],[70,78,92,68],[71,8,93,6,"timeout"],[71,15,93,13],[71,17,93,15],[72,6,94,4],[72,7,94,5],[72,8,94,6],[73,6,96,4],[73,10,96,8],[73,11,96,9,"response"],[73,19,96,17],[73,20,96,18,"data"],[73,24,96,22],[73,28,96,26],[73,29,96,27,"response"],[73,37,96,35],[73,38,96,36,"data"],[73,42,96,40],[73,43,96,41,"success"],[73,50,96,48],[73,54,96,52],[73,55,96,53,"Array"],[73,60,96,58],[73,61,96,59,"isArray"],[73,68,96,66],[73,69,96,67,"response"],[73,77,96,75],[73,78,96,76,"data"],[73,82,96,80],[73,83,96,81,"data"],[73,87,96,85],[73,88,96,86],[73,90,96,88],[74,8,97,6,"console"],[74,15,97,13],[74,16,97,14,"log"],[74,19,97,17],[74,20,97,18],[74,85,97,83],[74,86,97,84],[75,8,98,6],[75,15,98,13,"AUTO_DJ"],[75,22,98,20],[76,6,99,4],[77,6,101,4],[77,12,101,10,"scheduleData"],[77,24,101,22],[77,27,101,25,"response"],[77,35,101,33],[77,36,101,34,"data"],[77,40,101,38],[77,41,101,39,"data"],[77,45,101,61],[78,6,102,4],[78,12,102,10,"now"],[78,15,102,13],[78,18,102,16],[78,22,102,20,"Date"],[78,26,102,24],[78,27,102,25],[78,28,102,26],[79,6,104,4,"console"],[79,13,104,11],[79,14,104,12,"log"],[79,17,104,15],[79,18,104,16],[79,53,104,51,"now"],[79,56,104,54],[79,57,104,55,"toISOString"],[79,68,104,66],[79,69,104,67],[79,70,104,68],[79,80,104,78,"now"],[79,83,104,81],[79,84,104,82,"getUTCDay"],[79,93,104,91],[79,94,104,92],[79,95,104,93],[79,106,104,104,"now"],[79,109,104,107],[79,110,104,108,"getUTCHours"],[79,121,104,119],[79,122,104,120],[79,123,104,121],[79,125,104,123],[79,126,104,124],[80,6,105,4,"console"],[80,13,105,11],[80,14,105,12,"log"],[80,17,105,15],[80,18,105,16],[80,49,105,47,"scheduleData"],[80,61,105,59],[80,62,105,60,"length"],[80,68,105,66],[80,95,105,93],[80,96,105,94],[82,6,107,4],[83,6,108,4],[84,6,109,4],[84,12,109,10,"sortedShows"],[84,23,109,21],[84,26,109,24],[84,27,109,25],[84,30,109,28,"scheduleData"],[84,42,109,40],[84,43,109,41],[84,44,109,42,"sort"],[84,48,109,46],[84,49,109,47],[84,50,109,48,"a"],[84,51,109,49],[84,53,109,51,"b"],[84,54,109,52],[84,59,109,57],[85,8,110,6],[86,8,111,6],[86,12,111,10,"a"],[86,13,111,11],[86,14,111,12,"permanent"],[86,23,111,21],[86,27,111,25],[86,28,111,26,"b"],[86,29,111,27],[86,30,111,28,"permanent"],[86,39,111,37],[86,41,111,39],[86,48,111,46],[86,49,111,47],[86,50,111,48],[87,8,112,6],[87,12,112,10],[87,13,112,11,"a"],[87,14,112,12],[87,15,112,13,"permanent"],[87,24,112,22],[87,28,112,26,"b"],[87,29,112,27],[87,30,112,28,"permanent"],[87,39,112,37],[87,41,112,39],[87,48,112,46],[87,49,112,47],[88,8,113,6],[88,15,113,13],[88,16,113,14],[89,6,114,4],[89,7,114,5],[89,8,114,6],[90,6,116,4],[90,12,116,10,"liveShow"],[90,20,116,18],[90,23,116,21,"sortedShows"],[90,34,116,32],[90,35,116,33,"find"],[90,39,116,37],[90,40,116,38,"show"],[90,44,116,42],[90,48,116,46],[91,8,117,6],[92,8,118,6],[92,12,118,10],[92,13,118,11,"show"],[92,17,118,15],[92,18,118,16,"users_permissions_user"],[92,40,118,38],[92,42,118,40],[92,49,118,47],[92,54,118,52],[93,8,119,6],[93,15,119,13,"isShowLive"],[93,25,119,23],[93,26,119,24,"show"],[93,30,119,28],[93,32,119,30,"now"],[93,35,119,33],[93,36,119,34],[94,6,120,4],[94,7,120,5],[94,8,120,6],[95,6,122,4],[95,10,122,8,"liveShow"],[95,18,122,16],[95,22,122,20,"liveShow"],[95,30,122,28],[95,31,122,29,"users_permissions_user"],[95,53,122,51],[95,55,122,53],[96,8,123,6],[96,14,123,12,"presenter"],[96,23,123,21],[96,26,123,24,"liveShow"],[96,34,123,32],[96,35,123,33,"users_permissions_user"],[96,57,123,55],[97,8,124,6],[97,14,124,12,"photoUrl"],[97,22,124,20],[97,25,124,23,"presenter"],[97,34,124,32],[97,35,124,33,"profile_photo"],[97,48,124,46],[97,50,124,48,"url"],[97,53,124,51],[97,56,125,10],[97,78,125,32,"presenter"],[97,87,125,41],[97,88,125,42,"profile_photo"],[97,101,125,55],[97,102,125,56,"url"],[97,105,125,59],[97,107,125,61],[97,110,126,10],[97,114,126,14],[98,8,128,6,"console"],[98,15,128,13],[98,16,128,14,"log"],[98,19,128,17],[98,20,128,18],[98,62,128,60],[98,64,128,62,"presenter"],[98,73,128,71],[98,74,128,72,"username"],[98,82,128,80],[98,84,128,82],[98,91,128,89],[98,93,128,91,"liveShow"],[98,101,128,99],[98,102,128,100,"show_name"],[98,111,128,109],[98,112,128,110],[99,8,130,6],[99,15,130,13],[100,10,131,8,"name"],[100,14,131,12],[100,16,131,14,"presenter"],[100,25,131,23],[100,26,131,24,"username"],[100,34,131,32],[101,10,132,8,"description"],[101,21,132,19],[101,23,132,21,"liveShow"],[101,31,132,29],[101,32,132,30,"description"],[101,43,132,41],[101,47,132,45],[101,49,132,47],[102,10,133,8,"showName"],[102,18,133,16],[102,20,133,18,"liveShow"],[102,28,133,26],[102,29,133,27,"show_name"],[102,38,133,36],[103,10,134,8,"photoUrl"],[103,18,134,16],[104,10,135,8,"isAutoDJ"],[104,18,135,16],[104,20,135,18],[104,25,135,23],[105,10,136,8,"endTime"],[105,17,136,15],[105,19,136,17,"liveShow"],[105,27,136,25],[105,28,136,26,"end_time"],[106,8,137,6],[106,9,137,7],[107,6,138,4],[108,6,140,4,"console"],[108,13,140,11],[108,14,140,12,"log"],[108,17,140,15],[108,18,140,16],[108,76,140,74],[108,77,140,75],[109,6,141,4],[109,13,141,11,"AUTO_DJ"],[109,20,141,18],[110,4,143,2],[110,5,143,3],[110,6,143,4],[110,13,143,11,"error"],[110,18,143,16],[110,20,143,18],[111,6,144,4,"console"],[111,13,144,11],[111,14,144,12,"error"],[111,19,144,17],[111,20,144,18],[111,71,144,69],[111,73,144,71,"error"],[111,78,144,76],[111,79,144,77],[112,6,145,4],[112,13,145,11,"AUTO_DJ"],[112,20,145,18],[113,4,146,2],[114,2,147,0],[114,3,147,1],[115,0,147,2],[115,3]],"functionMap":{"names":["<global>","isShowLive","getLivePresenter","sort$argument_0","sortedShows.find$argument_0"],"mappings":"AAA;mBCwC;CD0C;gCEK;+CCqB;KDK;sCEE;KFI;CF2B"},"hasCjsExports":false},"type":"js/module"}]}