{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"getLivePresenter\", {\n    enumerable: true,\n    get: function () {\n      return getLivePresenter;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || '';\n\n  // Default auto-DJ when no live show\n  const AUTO_DJ = {\n    name: 'DJ Cruise Control',\n    description: 'Full throttle tunes...',\n    showName: 'Auto DJ',\n    photoUrl: null,\n    isAutoDJ: true\n  };\n  /**\n   * Check if a show is currently live based on time\n   */\n  const isShowLive = (show, now) => {\n    const startTime = new Date(show.start_time);\n    const endTime = new Date(show.end_time);\n    if (show.permanent) {\n      // For permanent/recurring shows, match by day of week and time only\n      // getUTCDay(): 0 = Sunday, 1 = Monday, ..., 6 = Saturday\n      const nowDay = now.getUTCDay();\n      const showDay = startTime.getUTCDay();\n      const nowHours = now.getUTCHours();\n      const nowMinutes = now.getUTCMinutes();\n      const nowTotalMinutes = nowHours * 60 + nowMinutes;\n      const startHours = startTime.getUTCHours();\n      const startMinutes = startTime.getUTCMinutes();\n      const startTotalMinutes = startHours * 60 + startMinutes;\n      const endHours = endTime.getUTCHours();\n      const endMinutes = endTime.getUTCMinutes();\n      const endTotalMinutes = endHours * 60 + endMinutes;\n      const isSameDay = nowDay === showDay;\n      const isWithinTime = nowTotalMinutes >= startTotalMinutes && nowTotalMinutes < endTotalMinutes;\n\n      // Debug logging\n      console.log(`[isShowLive] ${show.show_name}: nowDay=${nowDay}, showDay=${showDay}, ` + `nowTime=${nowHours}:${nowMinutes} (${nowTotalMinutes}min), ` + `showTime=${startHours}:${startMinutes}-${endHours}:${endMinutes} (${startTotalMinutes}-${endTotalMinutes}min), ` + `sameDay=${isSameDay}, withinTime=${isWithinTime}`);\n      return isSameDay && isWithinTime;\n    } else {\n      // For one-time shows, check if current timestamp is within the exact range\n      const isLive = now >= startTime && now < endTime;\n      console.log(`[isShowLive] ${show.show_name} (one-time): ` + `now=${now.toISOString()}, start=${startTime.toISOString()}, end=${endTime.toISOString()}, ` + `isLive=${isLive}`);\n      return isLive;\n    }\n  };\n\n  /**\n   * Fetch the current live presenter from schedule data\n   */\n  const getLivePresenter = async () => {\n    try {\n      console.log('[PresenterService] Fetching schedule for live presenter check');\n      const response = await axios.default.get(`${BACKEND_URL}/api/schedule`, {\n        timeout: 10000\n      });\n      if (!response.data || !response.data.success || !Array.isArray(response.data.data)) {\n        console.log('[PresenterService] Invalid schedule response, returning auto-DJ');\n        return AUTO_DJ;\n      }\n      const scheduleData = response.data.data;\n      const now = new Date();\n      console.log(`[PresenterService] Current UTC: ${now.toISOString()}, Day: ${now.getUTCDay()}, Hour: ${now.getUTCHours()}`);\n      console.log(`[PresenterService] Checking ${scheduleData.length} shows for live presenter`);\n\n      // Find the currently live show - check permanent shows first as they're recurring\n      // Sort to prioritize permanent shows that match the current time slot\n      const sortedShows = [...scheduleData].sort((a, b) => {\n        // Prioritize permanent shows\n        if (a.permanent && !b.permanent) return -1;\n        if (!a.permanent && b.permanent) return 1;\n        return 0;\n      });\n      const liveShow = sortedShows.find(show => {\n        // Skip shows without a presenter\n        if (!show.users_permissions_user) return false;\n        return isShowLive(show, now);\n      });\n      if (liveShow && liveShow.users_permissions_user) {\n        const presenter = liveShow.users_permissions_user;\n        const photoUrl = presenter.profile_photo?.url ? `https://trucksim.fm${presenter.profile_photo.url}` : null;\n        console.log('[PresenterService] Found live presenter:', presenter.username, 'Show:', liveShow.show_name);\n        return {\n          name: presenter.username,\n          description: liveShow.description || '',\n          showName: liveShow.show_name,\n          photoUrl,\n          isAutoDJ: false,\n          endTime: liveShow.end_time\n        };\n      }\n      console.log('[PresenterService] No live show found, returning auto-DJ');\n      return AUTO_DJ;\n    } catch (error) {\n      console.error('[PresenterService] Error fetching live presenter:', error);\n      return AUTO_DJ;\n    }\n  };\n});","lineCount":116,"map":[[12,2,88,0,"Object"],[12,8,88,0],[12,9,88,0,"defineProperty"],[12,23,88,0],[12,24,88,0,"exports"],[12,31,88,0],[13,4,88,0,"enumerable"],[13,14,88,0],[14,4,88,0,"get"],[14,7,88,0],[14,18,88,0,"get"],[14,19,88,0],[15,6,88,0],[15,13,88,0,"getLivePresenter"],[15,29,88,0],[16,4,88,0],[17,2,88,0],[18,2,147,2],[18,6,147,2,"_expoVirtualEnv"],[18,21,147,2],[18,24,147,2,"require"],[18,31,147,2],[18,32,147,2,"_dependencyMap"],[18,46,147,2],[19,2,1,0],[19,6,1,0,"_axios"],[19,12,1,0],[19,15,1,0,"require"],[19,22,1,0],[19,23,1,0,"_dependencyMap"],[19,37,1,0],[20,2,1,0],[20,6,1,0,"axios"],[20,11,1,0],[20,14,1,0,"_interopDefault"],[20,29,1,0],[20,30,1,0,"_axios"],[20,36,1,0],[21,2,3,0],[21,8,3,6,"BACKEND_URL"],[21,19,3,17],[21,22,3,20,"_expoVirtualEnv"],[21,37,3,20],[21,38,3,20,"env"],[21,41,3,20],[21,42,3,20,"EXPO_PUBLIC_BACKEND_URL"],[21,65,3,20],[21,69,3,59],[21,71,3,61],[23,2,5,0],[24,2,6,0],[24,8,6,6,"AUTO_DJ"],[24,15,6,13],[24,18,6,16],[25,4,7,2,"name"],[25,8,7,6],[25,10,7,8],[25,29,7,27],[26,4,8,2,"description"],[26,15,8,13],[26,17,8,15],[26,41,8,39],[27,4,9,2,"showName"],[27,12,9,10],[27,14,9,12],[27,23,9,21],[28,4,10,2,"photoUrl"],[28,12,10,10],[28,14,10,12],[28,18,10,16],[29,4,11,2,"isAutoDJ"],[29,12,11,10],[29,14,11,12],[30,2,12,0],[30,3,12,1],[31,2,38,0],[32,0,39,0],[33,0,40,0],[34,2,41,0],[34,8,41,6,"isShowLive"],[34,18,41,16],[34,21,41,19,"isShowLive"],[34,22,41,20,"show"],[34,26,41,38],[34,28,41,40,"now"],[34,31,41,49],[34,36,41,63],[35,4,42,2],[35,10,42,8,"startTime"],[35,19,42,17],[35,22,42,20],[35,26,42,24,"Date"],[35,30,42,28],[35,31,42,29,"show"],[35,35,42,33],[35,36,42,34,"start_time"],[35,46,42,44],[35,47,42,45],[36,4,43,2],[36,10,43,8,"endTime"],[36,17,43,15],[36,20,43,18],[36,24,43,22,"Date"],[36,28,43,26],[36,29,43,27,"show"],[36,33,43,31],[36,34,43,32,"end_time"],[36,42,43,40],[36,43,43,41],[37,4,45,2],[37,8,45,6,"show"],[37,12,45,10],[37,13,45,11,"permanent"],[37,22,45,20],[37,24,45,22],[38,6,46,4],[39,6,47,4],[40,6,48,4],[40,12,48,10,"nowDay"],[40,18,48,16],[40,21,48,19,"now"],[40,24,48,22],[40,25,48,23,"getUTCDay"],[40,34,48,32],[40,35,48,33],[40,36,48,34],[41,6,49,4],[41,12,49,10,"showDay"],[41,19,49,17],[41,22,49,20,"startTime"],[41,31,49,29],[41,32,49,30,"getUTCDay"],[41,41,49,39],[41,42,49,40],[41,43,49,41],[42,6,51,4],[42,12,51,10,"nowHours"],[42,20,51,18],[42,23,51,21,"now"],[42,26,51,24],[42,27,51,25,"getUTCHours"],[42,38,51,36],[42,39,51,37],[42,40,51,38],[43,6,52,4],[43,12,52,10,"nowMinutes"],[43,22,52,20],[43,25,52,23,"now"],[43,28,52,26],[43,29,52,27,"getUTCMinutes"],[43,42,52,40],[43,43,52,41],[43,44,52,42],[44,6,53,4],[44,12,53,10,"nowTotalMinutes"],[44,27,53,25],[44,30,53,28,"nowHours"],[44,38,53,36],[44,41,53,39],[44,43,53,41],[44,46,53,44,"nowMinutes"],[44,56,53,54],[45,6,55,4],[45,12,55,10,"startHours"],[45,22,55,20],[45,25,55,23,"startTime"],[45,34,55,32],[45,35,55,33,"getUTCHours"],[45,46,55,44],[45,47,55,45],[45,48,55,46],[46,6,56,4],[46,12,56,10,"startMinutes"],[46,24,56,22],[46,27,56,25,"startTime"],[46,36,56,34],[46,37,56,35,"getUTCMinutes"],[46,50,56,48],[46,51,56,49],[46,52,56,50],[47,6,57,4],[47,12,57,10,"startTotalMinutes"],[47,29,57,27],[47,32,57,30,"startHours"],[47,42,57,40],[47,45,57,43],[47,47,57,45],[47,50,57,48,"startMinutes"],[47,62,57,60],[48,6,59,4],[48,12,59,10,"endHours"],[48,20,59,18],[48,23,59,21,"endTime"],[48,30,59,28],[48,31,59,29,"getUTCHours"],[48,42,59,40],[48,43,59,41],[48,44,59,42],[49,6,60,4],[49,12,60,10,"endMinutes"],[49,22,60,20],[49,25,60,23,"endTime"],[49,32,60,30],[49,33,60,31,"getUTCMinutes"],[49,46,60,44],[49,47,60,45],[49,48,60,46],[50,6,61,4],[50,12,61,10,"endTotalMinutes"],[50,27,61,25],[50,30,61,28,"endHours"],[50,38,61,36],[50,41,61,39],[50,43,61,41],[50,46,61,44,"endMinutes"],[50,56,61,54],[51,6,63,4],[51,12,63,10,"isSameDay"],[51,21,63,19],[51,24,63,22,"nowDay"],[51,30,63,28],[51,35,63,33,"showDay"],[51,42,63,40],[52,6,64,4],[52,12,64,10,"isWithinTime"],[52,24,64,22],[52,27,64,25,"nowTotalMinutes"],[52,42,64,40],[52,46,64,44,"startTotalMinutes"],[52,63,64,61],[52,67,64,65,"nowTotalMinutes"],[52,82,64,80],[52,85,64,83,"endTotalMinutes"],[52,100,64,98],[54,6,66,4],[55,6,67,4,"console"],[55,13,67,11],[55,14,67,12,"log"],[55,17,67,15],[55,18,67,16],[55,34,67,32,"show"],[55,38,67,36],[55,39,67,37,"show_name"],[55,48,67,46],[55,60,67,58,"nowDay"],[55,66,67,64],[55,79,67,77,"showDay"],[55,86,67,84],[55,90,67,88],[55,93,68,6],[55,104,68,17,"nowHours"],[55,112,68,25],[55,116,68,29,"nowMinutes"],[55,126,68,39],[55,131,68,44,"nowTotalMinutes"],[55,146,68,59],[55,154,68,67],[55,157,69,6],[55,169,69,18,"startHours"],[55,179,69,28],[55,183,69,32,"startMinutes"],[55,195,69,44],[55,199,69,48,"endHours"],[55,207,69,56],[55,211,69,60,"endMinutes"],[55,221,69,70],[55,226,69,75,"startTotalMinutes"],[55,243,69,92],[55,247,69,96,"endTotalMinutes"],[55,262,69,111],[55,270,69,119],[55,273,70,6],[55,284,70,17,"isSameDay"],[55,293,70,26],[55,309,70,42,"isWithinTime"],[55,321,70,54],[55,323,70,56],[55,324,70,57],[56,6,72,4],[56,13,72,11,"isSameDay"],[56,22,72,20],[56,26,72,24,"isWithinTime"],[56,38,72,36],[57,4,73,2],[57,5,73,3],[57,11,73,9],[58,6,74,4],[59,6,75,4],[59,12,75,10,"isLive"],[59,18,75,16],[59,21,75,19,"now"],[59,24,75,22],[59,28,75,26,"startTime"],[59,37,75,35],[59,41,75,39,"now"],[59,44,75,42],[59,47,75,45,"endTime"],[59,54,75,52],[60,6,77,4,"console"],[60,13,77,11],[60,14,77,12,"log"],[60,17,77,15],[60,18,77,16],[60,34,77,32,"show"],[60,38,77,36],[60,39,77,37,"show_name"],[60,48,77,46],[60,63,77,61],[60,66,78,6],[60,73,78,13,"now"],[60,76,78,16],[60,77,78,17,"toISOString"],[60,88,78,28],[60,89,78,29],[60,90,78,30],[60,101,78,41,"startTime"],[60,110,78,50],[60,111,78,51,"toISOString"],[60,122,78,62],[60,123,78,63],[60,124,78,64],[60,133,78,73,"endTime"],[60,140,78,80],[60,141,78,81,"toISOString"],[60,152,78,92],[60,153,78,93],[60,154,78,94],[60,158,78,98],[60,161,79,6],[60,171,79,16,"isLive"],[60,177,79,22],[60,179,79,24],[60,180,79,25],[61,6,81,4],[61,13,81,11,"isLive"],[61,19,81,17],[62,4,82,2],[63,2,83,0],[63,3,83,1],[65,2,85,0],[66,0,86,0],[67,0,87,0],[68,2,88,7],[68,8,88,13,"getLivePresenter"],[68,24,88,29],[68,27,88,32],[68,33,88,32,"getLivePresenter"],[68,34,88,32],[68,39,88,68],[69,4,89,2],[69,8,89,6],[70,6,90,4,"console"],[70,13,90,11],[70,14,90,12,"log"],[70,17,90,15],[70,18,90,16],[70,81,90,79],[70,82,90,80],[71,6,92,4],[71,12,92,10,"response"],[71,20,92,18],[71,23,92,21],[71,29,92,27,"axios"],[71,34,92,32],[71,35,92,32,"default"],[71,42,92,32],[71,43,92,33,"get"],[71,46,92,36],[71,47,92,37],[71,50,92,40,"BACKEND_URL"],[71,61,92,51],[71,76,92,66],[71,78,92,68],[72,8,93,6,"timeout"],[72,15,93,13],[72,17,93,15],[73,6,94,4],[73,7,94,5],[73,8,94,6],[74,6,96,4],[74,10,96,8],[74,11,96,9,"response"],[74,19,96,17],[74,20,96,18,"data"],[74,24,96,22],[74,28,96,26],[74,29,96,27,"response"],[74,37,96,35],[74,38,96,36,"data"],[74,42,96,40],[74,43,96,41,"success"],[74,50,96,48],[74,54,96,52],[74,55,96,53,"Array"],[74,60,96,58],[74,61,96,59,"isArray"],[74,68,96,66],[74,69,96,67,"response"],[74,77,96,75],[74,78,96,76,"data"],[74,82,96,80],[74,83,96,81,"data"],[74,87,96,85],[74,88,96,86],[74,90,96,88],[75,8,97,6,"console"],[75,15,97,13],[75,16,97,14,"log"],[75,19,97,17],[75,20,97,18],[75,85,97,83],[75,86,97,84],[76,8,98,6],[76,15,98,13,"AUTO_DJ"],[76,22,98,20],[77,6,99,4],[78,6,101,4],[78,12,101,10,"scheduleData"],[78,24,101,22],[78,27,101,25,"response"],[78,35,101,33],[78,36,101,34,"data"],[78,40,101,38],[78,41,101,39,"data"],[78,45,101,61],[79,6,102,4],[79,12,102,10,"now"],[79,15,102,13],[79,18,102,16],[79,22,102,20,"Date"],[79,26,102,24],[79,27,102,25],[79,28,102,26],[80,6,104,4,"console"],[80,13,104,11],[80,14,104,12,"log"],[80,17,104,15],[80,18,104,16],[80,53,104,51,"now"],[80,56,104,54],[80,57,104,55,"toISOString"],[80,68,104,66],[80,69,104,67],[80,70,104,68],[80,80,104,78,"now"],[80,83,104,81],[80,84,104,82,"getUTCDay"],[80,93,104,91],[80,94,104,92],[80,95,104,93],[80,106,104,104,"now"],[80,109,104,107],[80,110,104,108,"getUTCHours"],[80,121,104,119],[80,122,104,120],[80,123,104,121],[80,125,104,123],[80,126,104,124],[81,6,105,4,"console"],[81,13,105,11],[81,14,105,12,"log"],[81,17,105,15],[81,18,105,16],[81,49,105,47,"scheduleData"],[81,61,105,59],[81,62,105,60,"length"],[81,68,105,66],[81,95,105,93],[81,96,105,94],[83,6,107,4],[84,6,108,4],[85,6,109,4],[85,12,109,10,"sortedShows"],[85,23,109,21],[85,26,109,24],[85,27,109,25],[85,30,109,28,"scheduleData"],[85,42,109,40],[85,43,109,41],[85,44,109,42,"sort"],[85,48,109,46],[85,49,109,47],[85,50,109,48,"a"],[85,51,109,49],[85,53,109,51,"b"],[85,54,109,52],[85,59,109,57],[86,8,110,6],[87,8,111,6],[87,12,111,10,"a"],[87,13,111,11],[87,14,111,12,"permanent"],[87,23,111,21],[87,27,111,25],[87,28,111,26,"b"],[87,29,111,27],[87,30,111,28,"permanent"],[87,39,111,37],[87,41,111,39],[87,48,111,46],[87,49,111,47],[87,50,111,48],[88,8,112,6],[88,12,112,10],[88,13,112,11,"a"],[88,14,112,12],[88,15,112,13,"permanent"],[88,24,112,22],[88,28,112,26,"b"],[88,29,112,27],[88,30,112,28,"permanent"],[88,39,112,37],[88,41,112,39],[88,48,112,46],[88,49,112,47],[89,8,113,6],[89,15,113,13],[89,16,113,14],[90,6,114,4],[90,7,114,5],[90,8,114,6],[91,6,116,4],[91,12,116,10,"liveShow"],[91,20,116,18],[91,23,116,21,"sortedShows"],[91,34,116,32],[91,35,116,33,"find"],[91,39,116,37],[91,40,116,38,"show"],[91,44,116,42],[91,48,116,46],[92,8,117,6],[93,8,118,6],[93,12,118,10],[93,13,118,11,"show"],[93,17,118,15],[93,18,118,16,"users_permissions_user"],[93,40,118,38],[93,42,118,40],[93,49,118,47],[93,54,118,52],[94,8,119,6],[94,15,119,13,"isShowLive"],[94,25,119,23],[94,26,119,24,"show"],[94,30,119,28],[94,32,119,30,"now"],[94,35,119,33],[94,36,119,34],[95,6,120,4],[95,7,120,5],[95,8,120,6],[96,6,122,4],[96,10,122,8,"liveShow"],[96,18,122,16],[96,22,122,20,"liveShow"],[96,30,122,28],[96,31,122,29,"users_permissions_user"],[96,53,122,51],[96,55,122,53],[97,8,123,6],[97,14,123,12,"presenter"],[97,23,123,21],[97,26,123,24,"liveShow"],[97,34,123,32],[97,35,123,33,"users_permissions_user"],[97,57,123,55],[98,8,124,6],[98,14,124,12,"photoUrl"],[98,22,124,20],[98,25,124,23,"presenter"],[98,34,124,32],[98,35,124,33,"profile_photo"],[98,48,124,46],[98,50,124,48,"url"],[98,53,124,51],[98,56,125,10],[98,78,125,32,"presenter"],[98,87,125,41],[98,88,125,42,"profile_photo"],[98,101,125,55],[98,102,125,56,"url"],[98,105,125,59],[98,107,125,61],[98,110,126,10],[98,114,126,14],[99,8,128,6,"console"],[99,15,128,13],[99,16,128,14,"log"],[99,19,128,17],[99,20,128,18],[99,62,128,60],[99,64,128,62,"presenter"],[99,73,128,71],[99,74,128,72,"username"],[99,82,128,80],[99,84,128,82],[99,91,128,89],[99,93,128,91,"liveShow"],[99,101,128,99],[99,102,128,100,"show_name"],[99,111,128,109],[99,112,128,110],[100,8,130,6],[100,15,130,13],[101,10,131,8,"name"],[101,14,131,12],[101,16,131,14,"presenter"],[101,25,131,23],[101,26,131,24,"username"],[101,34,131,32],[102,10,132,8,"description"],[102,21,132,19],[102,23,132,21,"liveShow"],[102,31,132,29],[102,32,132,30,"description"],[102,43,132,41],[102,47,132,45],[102,49,132,47],[103,10,133,8,"showName"],[103,18,133,16],[103,20,133,18,"liveShow"],[103,28,133,26],[103,29,133,27,"show_name"],[103,38,133,36],[104,10,134,8,"photoUrl"],[104,18,134,16],[105,10,135,8,"isAutoDJ"],[105,18,135,16],[105,20,135,18],[105,25,135,23],[106,10,136,8,"endTime"],[106,17,136,15],[106,19,136,17,"liveShow"],[106,27,136,25],[106,28,136,26,"end_time"],[107,8,137,6],[107,9,137,7],[108,6,138,4],[109,6,140,4,"console"],[109,13,140,11],[109,14,140,12,"log"],[109,17,140,15],[109,18,140,16],[109,76,140,74],[109,77,140,75],[110,6,141,4],[110,13,141,11,"AUTO_DJ"],[110,20,141,18],[111,4,143,2],[111,5,143,3],[111,6,143,4],[111,13,143,11,"error"],[111,18,143,16],[111,20,143,18],[112,6,144,4,"console"],[112,13,144,11],[112,14,144,12,"error"],[112,19,144,17],[112,20,144,18],[112,71,144,69],[112,73,144,71,"error"],[112,78,144,76],[112,79,144,77],[113,6,145,4],[113,13,145,11,"AUTO_DJ"],[113,20,145,18],[114,4,146,2],[115,2,147,0],[115,3,147,1],[116,0,147,2],[116,3]],"functionMap":{"names":["<global>","isShowLive","getLivePresenter","sort$argument_0","sortedShows.find$argument_0"],"mappings":"AAA;mBCwC;CD0C;gCEK;+CCqB;KDK;sCEE;KFI;CF2B"},"hasCjsExports":false},"type":"js/module"}]}